Чириков Егор Константинович ит31.

Задание - отличать лошадь от мрт головного мозга.

Данные для тренировки модели:
/Brain-MRI/dataset/Training      col: 1 207
/horse_512/data/train            col: 9 849

Данные для тестирования модели:
/Brain-MRI/dataset/Testing       col: 340
/horse_512/data/validation       col: 1 049

Всего тренировачных данных: 11 056
Всего тестовых данных: 1 389

Циклов обучения: 8

Точность полученной модели - 92.66%

Из-за преобладания в тренеровачных данных коней, в сложных ситуациях, как например test_mrt4.jpg, сеть склонная относить картику к лошедям.
По этой же причине лошади распозгаються с большей уверенностью. МРТ всё ещё распознаяться с достачно высокой степенью вероятности. 
Что интересно, максимальная точность (95.39%) была достигнута на 4 цикле обучения. Это можно расценить, как просто небольшую флактуацию. Ведь в дальнейшем
точность распознования повышаеться.

-----------------------------------------------------------------

В файле main.py - код для создания и тренировки модели.

В файле use.py - код для её использования. Запуск через консоль. Далее потребуют от вас ввод пути до файла, который надо проанализировать.
Пример использования:
    (.venv) PS C:\Poekti\nSeti\my> py .\use.py
    Введите путь к файлу
    C:\Poekti\nSeti\my\test_horse3.jpg 
    Лошадь с вероятностью  0.99838305 , МРТ мозга с вероятностью  0.001616994

-----------------------------------------------------------------

Зависемости:

TensorFlow: 2.4.4
Keras: 2.4.3
OpenCV: 4.5.1
NumPy: 1.19.5
Pandas: 1.2.5
pillow 8.2.0
numpy 1.19.5

-----------------------------------------------------------------

Лог консоли:

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 185, 185, 16)      4112
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 92, 92, 16)        0
_________________________________________________________________
dropout (Dropout)            (None, 92, 92, 16)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 77, 77, 32)        131104
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 38, 38, 32)        0
_________________________________________________________________
dropout_1 (Dropout)          (None, 38, 38, 32)        0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 23, 23, 64)        524352
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 11, 11, 64)        0
_________________________________________________________________
flatten (Flatten)            (None, 7744)              0
_________________________________________________________________
dense (Dense)                (None, 64)                495680
_________________________________________________________________
dropout_2 (Dropout)          (None, 64)                0
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 130
=================================================================
Total params: 1,155,378
Trainable params: 1,155,378
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/8
11056/11056 [==============================] - 4222s 382ms/step - loss: 0.2755 - accuracy: 0.8853 - val_loss: 0.4418 - val_accuracy: 0.7552
Epoch 2/8
11056/11056 [==============================] - 4175s 378ms/step - loss: 0.2316 - accuracy: 0.8869 - val_loss: 0.4081 - val_accuracy: 0.7552
Epoch 3/8
11056/11056 [==============================] - 4154s 376ms/step - loss: 0.1806 - accuracy: 0.8899 - val_loss: 0.3456 - val_accuracy: 0.9388
Epoch 4/8
11056/11056 [==============================] - 4052s 367ms/step - loss: 0.1223 - accuracy: 0.9300 - val_loss: 0.2685 - val_accuracy: 0.9539
Epoch 5/8
11056/11056 [==============================] - 4048s 366ms/step - loss: 0.0897 - accuracy: 0.9693 - val_loss: 0.2200 - val_accuracy: 0.9345
Epoch 6/8
11056/11056 [==============================] - 4050s 366ms/step - loss: 0.0720 - accuracy: 0.9755 - val_loss: 0.1989 - val_accuracy: 0.9302
Epoch 7/8
11056/11056 [==============================] - 4128s 373ms/step - loss: 0.0622 - accuracy: 0.9786 - val_loss: 0.1756 - val_accuracy: 0.9352
Epoch 8/8
11056/11056 [==============================] - 4134s 374ms/step - loss: 0.0586 - accuracy: 0.9813 - val_loss: 0.1871 - val_accuracy: 0.9266
Потери на тесте: 0.18707285821437836
Точность на тесте: 0.9265658855438232
Baseline Error: 7.34%
Модель сохранена как testIT3.h5